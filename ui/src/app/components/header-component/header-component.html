<header class="app-header">
  <div class="content-container header-content">
    <div class="logo">
      <!-- Link to a parent/student dashboard or student management page -->
      <a routerLink="/dashboard">
        <!-- SVG for a book or learning symbol -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book-open"><path d="M2 12s4-8 10-8 10 8 10 8-4 8-10 8-10-8-10-8z"/><circle cx="12" cy="12" r="3"/></svg>
        Adaptive Learning
      </a>
    </div>

    <nav class="navbar">
      <!-- Student Dropdown (Visible only when logged in and students are loaded) -->
      <ng-container *ngIf="isLoggedIn$ | async">
        <div class="student-dropdown-container" (click)="toggleDropdown()">
          <button class="dropdown-toggle" [class.open]="isDropdownOpen">
            <!-- Display selected student name or a default message -->
            <span class="truncate-text">{{ selectedStudent ? selectedStudent.firstName : 'Parent' }}</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>
          </button>

          <div class="dropdown-menu" [class.show]="isDropdownOpen && students.length > 0">
            <a *ngFor="let student of students"
               class="dropdown-item"
               [class.active]="student === selectedStudent"
               (click)="selectStudent(student); $event.stopPropagation()">
              {{ student.firstName + ' ' +student.lastName }}
            </a>
          </div>
        </div>

        <a routerLink="/parent-profile" class="nav-link">Parent Profile</a>
      </ng-container>


      <!-- General Links - Visible when logged in -->
      <ng-container *ngIf="isLoggedIn$ | async">
        <a routerLink="/questionnaire/generate" routerLinkActive="active-link">Generate</a>
      </ng-container>

      <!-- Auth Links - Visible only if NOT logged in -->
      <ng-container *ngIf="(isLoggedIn$ | async) === false">
        <a routerLink="/login" routerLinkActive="active-link">Login</a>
        <a routerLink="/register" routerLinkActive="active-link">Register</a>
      </ng-container>

      <!-- Logout link ONLY if logged in -->
      <ng-container *ngIf="isLoggedIn$ | async">
        <a (click)="onLogout()" class="logout-link">Logout</a>
      </ng-container>
    </nav>
  </div>
</header>
